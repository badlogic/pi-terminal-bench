#!/bin/bash
set -e

apt-get update
apt-get install -y curl

# Install Node.js via nvm
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.2/install.sh | bash

export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"

nvm install 22
node -v
npm -v

# Install pi coding agent
{% if version %}
npm install -g @mariozechner/pi-coding-agent@{{ version }}
{% else %}
npm install -g @mariozechner/pi-coding-agent@latest
{% endif %}

# Verify installation
pi --help
